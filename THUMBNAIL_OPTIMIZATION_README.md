# 图片优化说明

## 功能概述

为了优化服务器压力和用户体验，我们实现了以下图片加载策略：

1. **缩略图显示**：瀑布流中显示的是缩略图（300x300px），加载速度快
2. **按需加载高清图**：只有点击图片查看时才加载高清原图
3. **预加载策略**：前15张图片立即加载，其余图片的缩略图在后台预加载

## 文件结构

```
public/mypub/
├── image_01.jpg          # 高清原图
├── image_02.jpg
├── ...
└── thumbnails/           # 缩略图文件夹
    ├── image_01.jpg      # 缩略图
    ├── image_02.jpg
    └── ...
```

## 生成缩略图

### 方法1：使用Python脚本（推荐）

1. 确保安装了Pillow库：
```bash
pip install Pillow
```

2. 运行生成脚本：
```bash
python generate_thumbnails.py
```

### 方法2：手动创建

1. 创建 `public/mypub/thumbnails/` 文件夹
2. 将原图压缩为300x300px的缩略图
3. 保持相同的文件名

## 技术实现

### 数据结构
```javascript
{
  type: 'image',
  src: '/mypub/image_01.jpg',        // 高清原图路径
  thumbnail: '/mypub/thumbnails/image_01.jpg', // 缩略图路径
  alt: 'Image 1',
  folder: 'gallery'
}
```

### 加载策略
1. **初始加载**：显示前15张缩略图
2. **后台预加载**：预加载其余图片的缩略图
3. **点击查看**：点击时加载高清原图
4. **状态指示**：已加载高清图的图片右上角显示绿色圆点

### 性能优化
- 缩略图大小：300x300px，质量85%
- 懒加载：使用 `loading="lazy"`
- 预加载：后台静默加载缩略图
- 按需加载：只有查看时才加载高清图

## 用户体验

1. **快速加载**：页面打开时立即显示缩略图
2. **流畅浏览**：瀑布流滚动流畅，无卡顿
3. **高清查看**：点击图片可查看高清原图
4. **加载反馈**：查看高清图时有加载动画
5. **状态指示**：已查看过的图片有绿色标记

## 服务器压力优化

- **减少带宽**：缩略图比原图小90%以上
- **按需传输**：只有用户主动查看时才传输高清图
- **缓存友好**：缩略图可以长期缓存
- **并发优化**：减少同时加载的大文件数量

## 注意事项

1. 确保缩略图文件夹存在且可访问
2. 缩略图文件名必须与原图相同
3. 建议缩略图格式为JPEG，质量85%
4. 如果缩略图不存在，会显示加载动画但无法正常显示
